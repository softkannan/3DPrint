Flash Arduino Pro Micro

In order to upload to the Arduino's microcontroller via the USB cable a program called a bootloader that is stored in a special section of memory needs to be running. This program runs on startup and waits for a short time to see if an upload will start. On Arduino boards like Uno, Nano, Mega the microcontroller is automatically reset by the serial connection being opened at the start of the upload, which causes the bootloader to run. On the ATmega32U4 boards like Pro Micro it's not possible to do that automatic reset so what the Arduino IDE does is open a serial connection at 1200 baud. There is some code added to the Pro Micro's sketch that interprets that 1200 baud connection as a special signal to to reset the board so that the bootloader will run. When the bootloader is running the board will actually show up on a different COM port so the Arduino IDE then scans for the first new COM port to appear and then starts the upload to that COM port via AVRDUDE.

Since it would be difficult to do the standard Pro Micro reset sequence from the command line I had you instead do a manual reset by momentarily connecting the RST pin to ground, which causes the bootloader to run. Then you just need to start the AVRDUDE command before the bootloader times out and exits to whatever program you had previously uploaded to the Pro Micro. Luckily the bootloader tends to be assigned the same COM port every time so that's why you could reuse the upload command generated by the Arduino IDE.


Automatic (Software) Reset and Bootloader Initiation 

Rather than requiring a physical press of the reset button before an upload, the Micro board is designed in a way that allows it to be reset by software running on a connected computer. The reset is triggered when the Micro's virtual (CDC) serial / COM port is opened at 1200 baud and then closed. When this happens, the processor will reset, breaking the USB connection to the computer (meaning that the virtual serial / COM port will disappear). After the processor resets, the bootloader starts, remaining active for about 8 seconds. The bootloader can also be initiated by pressing the reset button on the Micro. Note that when the board first powers up, it will jump straight to the user sketch, if present, rather than initiating the bootloader. Because of the way the Micro handles reset it's best to let the Arduino Software (IDE) try to initiate the reset before uploading, especially if you are in the habit of pressing the reset button before uploading on other boards. If the software can't reset the board, you can always start the bootloader by pressing the reset button on the board...